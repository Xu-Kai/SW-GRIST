
!----------------------------------------------------------------------------
! Copyright (c), GRIST-Dev
!
! Unless noted otherwise source code is licensed under the Apache-2.0 license.
! Additional copyright and license information can be found in the LICENSE file
! distributed with this code, or at http://https://github.com/grist-dev
!
! Version 1.0
! Description:   Set constants associated with hybrid vertical coordinate 
! Revision history:
!----------------------------------------------------------------------------

module grist_hpe_constants

  use grist_constants_dbl, only: i4, r8, rdry, gravity, one, zero
  use grist_nml_module, only: nlev, nlevp

  implicit none
  save 
  public

  !---------------------------------------------------
  !                 Kind attributions
  !---------------------------------------------------

  real(r8), allocatable        :: eta_face_a(:)
  real(r8), allocatable        :: eta_face_b(:)
  real(r8), allocatable        :: eta_face(:)
  real(r8), allocatable        :: eta_full_a(:)
  real(r8), allocatable        :: eta_full_b(:)
  real(r8), allocatable        :: eta_full(:)
  real(r8), allocatable        :: deta_face(:)   ! delta(a+b)
  real(r8), allocatable        :: deta_face_b(:) ! delta(b)
  real(r8), allocatable        :: deta_full(:)
  real(r8), allocatable        :: hypi(:)
  real(r8), allocatable        :: hypm(:)
  real(r8)                     :: p0

#ifdef DCMIP1
  real(r8), parameter          :: T0       = 300.0_r8
  real(r8), parameter          :: ztop     = 12000.0_r8
  real(r8), parameter          :: eta_top  = exp(-gravity * ztop / rdry / T0)
#endif

  contains

  subroutine init_hpe_constants
 real(r8) :: ztop, dz
  integer(i4) :: ilev

     if(.not.allocated(eta_face_a)) allocate(eta_face_a(nlevp))
     if(.not.allocated(eta_face_b)) allocate(eta_face_b(nlevp))
     if(.not.allocated(eta_face))   allocate(eta_face(nlevp))
     if(.not.allocated(eta_full_a)) allocate(eta_full_a(nlev))
     if(.not.allocated(eta_full_b)) allocate(eta_full_b(nlev))
     if(.not.allocated(eta_full))   allocate(eta_full(nlev))
     if(.not.allocated(deta_face))  allocate(deta_face(nlevp))
     if(.not.allocated(deta_face_b))allocate(deta_face_b(nlevp))
     if(.not.allocated(deta_full))  allocate(deta_full(nlev))
     if(.not.allocated(hypi))       allocate(hypi(nlevp))
     if(.not.allocated(hypm))       allocate(hypm(nlev))

     p0   =  1.e5_r8

! we define vertical resolution using number of full levels
     select case(nlev)
     case(1)
        eta_face_a = (/0.5_r8,0._r8/)
        eta_face_b = (/0._r8, 1._r8/)
     case(5)
        eta_face_a = (/0.32044_r8, 0.40235_r8, 0.25518_r8, 0.13431_r8, 0.04643_r8, 0._r8/)
        eta_face_b = (/0._r8     , 0._r8     , 0.25_r8   , 0.5_r8    , 0.75_r8   , 1._r8/)
     case(10)
        eta_face_a = (/0.2737592327457158_r8, 0.2574691274856134_r8, 0.2392257778961169_r8, 0.2188579122253837_r8, 0.1961834482057335_r8,&
                       0.171008960410953_r8, 0.1431291236866448_r8, 0.1123261317013542_r8, 0.07836908962461686_r8, 0.04101337989532572_r8,&
                       0._r8/)
        eta_face_b = (/0._r8, 0.05950522689853417_r8, 0.1261453522616924_r8, 0.2005460052239693_r8, 0.283372304056826_r8,&
                       0.3753308018298088_r8, 0.4771715194731282_r8, 0.5896900697201707_r8, 0.7137298755603581_r8, 0.8501844869888955_r8,&
                       1._r8/)
     case(18)
!
! CAM's 18(+1) full level coefficients
!
     eta_face_a =  (/0.00251499470323319, 0.00710360519587988, 0.0190425943583249, &
                     0.046075608581305,   0.081818588078022,   0.0786980539560318, &
                     0.0746317282319069,  0.0695530474185939,  0.0633905678987499, &
                     0.0562177114188669,  0.0481529273092749,  0.039492335170507 , &
                     0.0305845476686949,  0.0219334047287699,  0.01403667870909  , &
                     0.0074586505070329,  0.0026468755677342,  0.0, 0.0/)

     eta_face_b =  (/0.0, 0.0, 0.0, 0.0, 0.0, 0.0375697687268259, 0.0865262672305107, &
                     0.147671163082119, 0.22186444699764, 0.308222115039829, 0.40531820058823, &
                     0.509587526321408, 0.616832911968228, 0.720988512039177, &
                     0.81606125831604, 0.895257532596588, 0.953188955783837,  &
                     0.985056042671197, 1./)
     case(26)

     eta_face_a = (/0.0021940670, 0.00489520900, 0.00988241800, 0.0180520100, 0.02983723999999999,&
                    0.044623340 , 0.06160587000, 0.07851243000, 0.0773127100, 0.0759013100,&
                    0.074240860 , 0.07228744000, 0.06998932999, 0.0672857399, 0.06410508999999998,&
                    0.0603632200, 0.05596111000, 0.05078225000, 0.0446896000, 0.03752190999999994,&
                    0.0290894900, 0.02084739000, 0.01334443000, 0.0070849900, 0.00252136,&
                    0.,0./)

     eta_face_b = (/0., 0., 0., 0., 0., &
                    0., 0., 0., 0.015053090000, 0.03276228000, &
                    0.05359621999999997, 0.078106270000, 0.1069411000, 0.14086370000, 0.180772000, &
                    0.227722, 0.282956200, 0.347936400000, 0.42438220000, 0.5143168000, &
                    0.62012020000, 0.7235355000, 0.81767680000, 0.896215300000, 0.95347610000, &
                    0.9851121999999997, 1./)

     case(32)
     eta_face_a = (/0.001355239523947239, 0.001855239523947239, &
                    0.002255239523947239, 0.005031691864132881, 0.01015794742852449, 0.01855531707406044, &
                    0.03066912293434143 , 0.04586747661232948,  0.0633234828710556,  0.08070141822099686, &
                    0.09494104236364365 , 0.1116932108998299,   0.1314012706279755,  0.1545868068933487 , &
                    0.1818633526563644  , 0.1745979934930801,   0.1660506576299667,  0.1559951603412628 , &
                    0.1441654115915298  , 0.1302483081817627,   0.1138755679130554,  0.09461385756731033, &
                    0.07534445077180862 , 0.05765894055366516,  0.04273463785648346, 0.03164267912507057, &
                    0.02522121742367744 , 0.01919673755764961,  0.01361802686005831, 0.008531088940799236,&
                    0.003978818189352751, 0. , 0./)

     eta_face_b = (/0.,0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., &
                    0.0393548272550106, 0.08565375953912735, 0.1401220560073853, 0.2042011767625809, &
                    0.2795869112014771, 0.3682743608951569,  0.4726105630397797, 0.5769885182380676, &
                    0.6727869510650635, 0.7536284327507019,  0.8137109875679016, 0.8484946489334106, &
                    0.8811278939247131, 0.911346435546875,   0.9389012455940247, 0.9635598063468933, &
                    0.985112190246582 , 1./)


     case(30)
     eta_face_a = (/0.002255239523947239, 0.005031691864132881, 0.01015794742852449, 0.01855531707406044, &
                    0.03066912293434143 , 0.04586747661232948,  0.0633234828710556,  0.08070141822099686, &
                    0.09494104236364365 , 0.1116932108998299,   0.1314012706279755,  0.1545868068933487 , &
                    0.1818633526563644  , 0.1745979934930801,   0.1660506576299667,  0.1559951603412628 , &
                    0.1441654115915298  , 0.1302483081817627,   0.1138755679130554,  0.09461385756731033, &
                    0.07534445077180862 , 0.05765894055366516,  0.04273463785648346, 0.03164267912507057, &
                    0.02522121742367744 , 0.01919673755764961,  0.01361802686005831, 0.008531088940799236,&
                    0.003978818189352751, 0. , 0./)

     eta_face_b = (/0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., &
                    0.0393548272550106, 0.08565375953912735, 0.1401220560073853, 0.2042011767625809, &
                    0.2795869112014771, 0.3682743608951569,  0.4726105630397797, 0.5769885182380676, &
                    0.6727869510650635, 0.7536284327507019,  0.8137109875679016, 0.8484946489334106, &
                    0.8811278939247131, 0.911346435546875,   0.9389012455940247, 0.9635598063468933, &
                    0.985112190246582 , 1./)

#ifdef HOLEQ
 
     eta_face_a = (/0._r8,0._r8,0._r8,0._r8,0._r8,&
                    0._r8,0._r8,0._r8,0._r8,0._r8,&
                    0._r8,0._r8,0._r8,0._r8,0._r8,&
                    0._r8,0._r8,0._r8,0._r8,0._r8,&
                    0._r8,0._r8,0._r8,0._r8,0._r8,&
                    0._r8,0._r8,0._r8,0._r8,0._r8,&
                    0._r8/)

     eta_face_b = (/0.002_r8,              0.03526666666666667_r8, 0.06853333333333333_r8, 0.1018_r8,             0.1350666666666667_r8, &
                    0.1683333333333333_r8, 0.2016_r8,              0.2348666666666667_r8,  0.2681333333333333_r8, 0.3014_r8, &
                    0.3346666666666667_r8, 0.3679333333333333_r8,  0.4012_r8,              0.4344666666666667_r8, 0.4677333333333333_r8, &
                    0.501_r8             , 0.5342666666666667_r8,  0.5675333333333333_r8,  0.6008_r8,             0.6340666666666667_r8, &
                    0.6673333333333333_r8, 0.7006_r8,              0.7338666666666667_r8,  0.7671333333333333_r8, 0.8004_r8,&
                    0.8336666666666667_r8, 0.8669333333333333_r8,  0.9002_r8            ,  0.9334666666666667_r8, 0.9667333333333333_r8, &
                    1._r8/)
#endif

#ifdef HOLNEQ

     eta_face_a = (/0._r8,0._r8,0._r8,0._r8,0._r8,&
                    0._r8,0._r8,0._r8,0._r8,0._r8,&
                    0._r8,0._r8,0._r8,0._r8,0._r8,&
                    0._r8,0._r8,0._r8,0._r8,0._r8,&
                    0._r8,0._r8,0._r8,0._r8,0._r8,&
                    0._r8,0._r8,0._r8,0._r8,0._r8,&
                    0._r8/)

     eta_face_b = (/0.002_r8,                0.005031691864132881_r8, 0.01015794742852449_r8, 0.01855531707406044_r8, &
                    0.022323232332323232_r8, 0.023232323232_r8      , 0.02612312312312312_r8, 0.02812312312312312_r8, &
                    0.030012312312312312_r8, 0.0323232323232323_r8  , 0.03445454545454545_r8, 0.03623232323232322_r8, &
                    0.038000001212_r8      , 0.0393548272550106_r8  , 0.08565375953912735_r8, 0.1401220560073853_r8,  &
                    0.2042011767625809_r8  , 0.2795869112014771_r8  , 0.3682743608951569_r8 , 0.4726105630397797_r8,  &
                    0.5769885182380676_r8  , 0.6727869510650635_r8  , 0.7536284327507019_r8 , 0.8137109875679016_r8,  &
                    0.8484946489334106_r8  , 0.8811278939247131_r8  , 0.911346435546875_r8  , 0.9389012455940247_r8,  &
                    0.9635598063468933_r8  , 0.985112190246582_r8   , 1._r8/)
#endif

#ifdef DCMIP1
     eta_face_a = (/0.2549437895196341_r8, 0.2508776170373553_r8, 0.2466219172622748_r8, 0.2421678561877506_r8, 0.2375061880475876_r8,&
                    0.2326272361236217_r8, 0.2275208726587316_r8, 0.222176497833581_r8, 0.2165830177634507_r8, 0.2107288214694878_r8,&
                    0.2046017567765677_r8, 0.1981891050877367_r8, 0.1914775549828742_r8, 0.1844531745867685_r8, 0.1771013826492478_r8,&
                    0.1694069182773354_r8, 0.1613538092565985_r8, 0.1529253388959313_r8, 0.1441040113269489_r8, 0.1348715151859615_r8,&
                    0.1252086856031369_r8, 0.1150954644199518_r8, 0.1045108585523475_r8, 0.0934328964131631_r8, 0.08183858230338514_r8,&
                    0.06970384867754043_r8, 0.05700350618414329_r8, 0.04371119137749158_r8, 0.02979931199227104_r8, 0.01523898966736859_r8,&
                    0._r8/)

     eta_face_b = (/0._r8, 0.01594929019428304_r8, 0.03264198854594341_r8, 0.05011274585647277_r8, 0.06839782802672914_r8,&
                    0.08753519133790777_r8, 0.1075645612414127_r8, 0.1285275148211823_r8, 0.1504675670996456_r8, 0.1734302613664615_r8,&
                    0.1974632637175477_r8, 0.2226164620006428_r8, 0.2489420693727946_r8, 0.276494732684739_r8, 0.3053316459171539_r8,&
                    0.3355126689042613_r8, 0.3671004515912238_r8, 0.4001605640832684_r8, 0.4347616327564984_r8, 0.4709754827129273_r8,&
                    0.5088772868754501_r8, 0.5485457220322371_r8, 0.5900631321544754_r8, 0.6335156993264686_r8, 0.6789936226429141_r8,&
                    0.7265913054447154_r8, 0.7764075512819926_r8, 0.8285457690110736_r8, 0.8831141874512063_r8, 0.9402260800465783_r8,&
                    1._r8/)
#endif

#ifdef DCMIP20
     eta_face_a = (/0.2054023400841138_r8,  0.2020510253548442_r8,  0.1985304434476293_r8, 0.194834129792635_r8,   0.1909554507126023_r8 ,&
                    0.1868876009875602_r8,  0.1826236014124591_r8,  0.1781562963477811_r8, 0.1734783512631888_r8,  0.1685822502742658_r8 ,&
                    0.1634602936724066_r8,  0.1581045954479095_r8,  0.1525070808063277_r8, 0.1466594836781284_r8,  0.1405533442217144_r8 ,&
                    0.134180006319858_r8 ,  0.1275306150695957_r8,  0.1205961142656349_r8, 0.1133672438773196_r8,  0.1058345375192014_r8 ,&
                    0.09798831991526458_r8, 0.08981870435684935_r8, 0.081315590154318_r8,  0.07246866008250952_r8, 0.06326737782002467_r8,&
                    0.05370098538238566_r8, 0.0437585005491109_r8,  0.03342871428474836_r8,0.02270018815390562_r8, 0.01156125173031874_r8,&
                    0._r8/)

     eta_face_b = (/0._r8,                  0.01631585466795162_r8, 0.0334557855264473_r8, 0.05145126529303926_r8, 0.07033458998371392_r8,&
                    0.09013889076907119_r8, 0.1108981458649723_r8,  0.1326471924573752_r8, 0.1554217386610683_r8,  0.179258375512031_r8  ,&
                    0.2041945889931518_r8,  0.2302687720930321_r8,  0.2575202368976178_r8, 0.2859892267144071_r8,  0.3157169282289735_r8 ,&
                    0.346745483693563_r8,   0.379118003147525_r8,   0.4128785766693313_r8, 0.448072286659953_r8,   0.4847452201573684_r8 ,&
                    0.5229444811819689_r8,  0.5627182031126425_r8,  0.604115561093322_r8,  0.6471867844697726_r8,  0.6919831692564153_r8 ,&
                    0.7385570906329756_r8,  0.7869620154707512_r8,  0.8372525148882963_r8, 0.8894842768363316_r8,  0.9437141187116742_r8 ,&
                    1._r8/)

!      eta_face_a = (/0.2054023400841138_r8, 0.2183668800227958_r8, 0.2319862289740766_r8, 0.2462853950856742_r8, 0.2612900406963162_r8,&
!                     0.2770264917566314_r8, 0.2921578776582509_r8, 0.3084695246221442_r8, 0.325145735328722_r8, 0.3420804150907101_r8,&
!                     0.359140901438269_r8, 0.3761636635458395_r8, 0.3929494325141958_r8, 0.4092576979279592_r8, 0.4248004997547863_r8,&
!                     0.4392354377572628_r8, 0.452157813112704_r8, 0.4630918088376713_r8, 0.4714806068486118_r8, 0.4766753300104795_r8,&
!                     0.4779226872815462_r8, 0.4743511890020143_r8, 0.464955787440521_r8, 0.4485807848469859_r8, 0.4239008373999559_r8,&
!                     0.3893998685155081_r8, 0.3433476889330973_r8, 0.2837741037377833_r8, 0.2084402679403108_r8, 0.1148070323346075_r8,&
!                     0._r8/)

!      eta_face_b  = (/0._r8, 0._r8, 0._r8, 0._r8, 0._r8,&
!                      0._r8, 0.001363869619180497_r8, 0.00233396418301215_r8, 0.003754354595535094_r8, 0.005760210695586668_r8,&
!                      0.008513981227289379_r8, 0.01220970399510208_r8, 0.01707788518974979_r8, 0.02339101246457632_r8, 0.03146977269590161_r8,&
!                      0.04169005225615829_r8, 0.05449080510441669_r8, 0.07038288209729496_r8, 0.08995892368866082_r8, 0.1139044276660903_r8,&
!                      0.1430101138156873_r8, 0.1781857184674776_r8, 0.220475363807119_r8, 0.2710746597052962_r8, 0.3313497096764841_r8,&
!                      0.4028582074998531_r8, 0.4873728270867648_r8, 0.5869071254352614_r8, 0.7037441970499264_r8, 0.8404683381073854_r8,&
!                      1._r8/)

!        eta_face_a = (/0.2054023400841138_r8, 0.2183668800227958_r8, 0.2319862289740766_r8, 0.2462853950856742_r8, 0.2612900406963162_r8,&
!                       0.2770264917566314_r8, 0.2935217472774314_r8, 0.3108034888051563_r8, 0.1734783512631888_r8, 0.1685822502742658_r8,&
!                       0.1634602936724066_r8, 0.1581045954479095_r8, 0.1525070808063277_r8, 0.1466594836781284_r8, 0.1405533442217144_r8,&
!                       0.134180006319858_r8, 0.1275306150695957_r8, 0.1205961142656349_r8, 0.1133672438773196_r8, 0.1058345375192014_r8,&
!                       0.09798831991526458_r8, 0.08981870435684935_r8, 0.081315590154318_r8, 0.07246866008250952_r8, 0.06326737782002467_r8,&
!                       0.05370098538238566_r8, 0.0437585005491109_r8, 0.03342871428474836_r8, 0.02270018815390562_r8, 0.01156125173031874_r8,&
!                       0._r8/)

!        eta_face_b = (/0._r8, 0._r8, 0._r8,   0._r8, 0._r8, &
!                       0._r8, 0._r8, 0._r8,   0.1554217386610683_r8, 0.179258375512031_r8,&
!                       0.2041945889931518_r8, 0.2302687720930321_r8, 0.2575202368976178_r8, 0.2859892267144071_r8, 0.3157169282289735_r8,&
!                       0.346745483693563_r8,  0.379118003147525_r8, 0.4128785766693313_r8, 0.448072286659953_r8, 0.4847452201573684_r8,&
!                       0.5229444811819689_r8, 0.5627182031126425_r8, 0.604115561093322_r8, 0.6471867844697726_r8, 0.6919831692564153_r8,&
!                       0.7385570906329756_r8, 0.7869620154707512_r8, 0.8372525148882963_r8, 0.8894842768363316_r8, 0.9437141187116742_r8,&
!                       1._r8/)
#endif

     case(40)
!     eta_face_a = (/0.1025039799580591, 0.1085106112775176, 0.1148692252207011, 0.1216004476194305, 0.1287261129587656,&
!                    0.1362693352028837, 0.1441539149528652, 0.1525327282659127, 0.1613699833538416, 0.1706821309851309,&
!                    0.1804841211871424, 0.1907887928265178, 0.2016061224464679, 0.2129423036359716, 0.2247986225965693,&
!                   0.2371700888895653, 0.2500437723867583, 0.263396787969768,  0.2771938582396091, 0.2913843710684859,&
!                   0.3058988328448148, 0.3206445992492089, 0.335500742782206,  0.3503118893653523, 0.3648808243500269,&
!                   0.3789596302362132, 0.3922390731900408, 0.4043359017051966, 0.414777656877433,  0.4229845178516312,&
!                   0.4282476157994937, 0.4297031426127318, 0.4263014531699074, 0.4167702087781362, 0.3995704297206252,&
!                   0.3728441114363133, 0.3343518054028682, 0.2813982647927591, 0.2107438975271052, 0.1184993449044565,&
!                   0./)
    
!    eta_face_b = (/0., 0., 0., 0., 0., &
!                   0.,                      0.0001006678184185989, 0.0001750296426091579, 0.000286297351091855,  0.0004470470557568752,&
!                   0.0006730565559439935   , 0.0009840154318086433, 0.001404381721581086,  0.001964414249962276 , 0.002701415304293184 ,&
!                   0.003661225059236434    , 0.004900017132875779 , 0.006486454158990549,  0.008504273568856411 , 0.01105538723227453  ,&
!                   0.01426359461671468     , 0.01827902816661634  , 0.0232834722534691  ,  0.02949672397995322  , 0.03718419614408849  ,&
!                   0.04666600073904468     , 0.05832779661737079  , 0.07263373873417409 ,  0.09014193030416379  , 0.111522855164369    ,&
!                   0.1375813578856026      , 0.1692828464017652   , 0.2077845193086796  ,  0.2544725713002879   , 0.311006509942911    ,&
!                   0.3793719304592955      , 0.4619433487193876   , 0.5615589937106221  ,  0.6816098182842067   , 0.8261454115046987   ,&
!                   1./)

  eta_face_a = (/0.1025039799580591_r8 , 0.1018179561734005_r8 , 0.1010917320769832_r8 , 0.1003229519705039_r8 , 0.09950912211408078_r8 ,&
                 0.09864760263715414_r8, 0.09773559897537391_r8, 0.0967701528056974_r8 , 0.09574813245029265_r8, 0.0946662227181202_r8  ,&
                 0.09352091415124149_r8, 0.09230849164097177_r8, 0.09102502237695081_r8, 0.08966634309004112_r8, 0.0882280465476728_r8  ,&
                 0.08670546725782877_r8, 0.08509366633529811_r8, 0.08338741548110656_r8, 0.08158118002315787_r8, 0.0796691009630732_r8  ,&
                 0.07764497597099371_r8, 0.07550223926669675_r8, 0.07323394032176639_r8, 0.0708327213137312_r8 , 0.06829079325903814_r8 ,&
                 0.0655999107474412_r8 , 0.06275134519585163_r8, 0.059735856534889_r8  , 0.05654366323629351_r8, 0.05316441058397392_r8 ,&
                 0.04958713708577023_r8, 0.04580023891697926_r8, 0.0417914322803068_r8 , 0.03754771356014897_r8, 0.03305531714195531_r8 ,&
                 0.02829967075984829_r8, 0.0232653482276568_r8 , 0.01793601940003686_r8, 0.01229439720136161_r8, 0.006322181550559192_r8,&
                 0._r8/)

  eta_face_b = (/0._r8,                  0.006692655104117077_r8,0.01377749314371797_r8,0.02127749564892662_r8,0.0292169908446848_r8 ,&
                 0.03762173256572957_r8, 0.04651898379590992_r8, 0.05593760510282444_r8,0.06590814825464078_r8,0.07646295532276762_r8,&
                 0.08763626359184486_r8, 0.09946431661735464_r8, 0.1119854817910982_r8, 0.1252403747958928_r8, 0.1392719913531897_r8 ,&
                 0.1541258466909729_r8,  0.169850123184336_r8,   0.186495826647652_r8,  0.2041169517853076_r8, 0.2227706573376872_r8 ,&
                 0.2425174514905357_r8,  0.2634213881491285_r8,  0.2855502747139088_r8, 0.3089758920315744_r8, 0.3337742272350772_r8 ,&
                 0.3600257202278167_r8,  0.38781552461156_r8,    0.4172337839044817_r8, 0.4483759239453033_r8, 0.4813429624320262_r8 ,&
                 0.5162418365993261_r8,  0.5531857500975178_r8,  0.5922945401982802_r8, 0.6336950665182751_r8, 0.6775216225215809_r8 ,&
                 0.7239163711357605_r8,  0.773029805894599_r8,   0.8250212391033444_r8, 0.8800593186099503_r8, 0.9383225748585959_r8 ,&
                 1._r8/)
#ifdef FLAT_SCHAR
  eta_face_a = (/0.1025039799580591_r8, 0.1085106112775176_r8, 0.1148692252207011_r8, 0.1216004476194305_r8, 0.1287261129587656_r8,&
                 0.1362693352028837_r8, 0.1442545827712838_r8, 0.1527077579085218_r8, 0.1616562807049334_r8, 0.1711291780408878_r8,&
                 0.1811571777430863_r8, 0.1917728082583264_r8, 0.1904697560360646_r8, 0.1992215664069182_r8, 0.2081033503253796_r8,&
                 0.2170765373305924_r8, 0.2260947251739_r8, 0.2351025487717675_r8, 0.2440344018023399_r8, 0.2528129925300951_r8,&
                 0.2613477131840651_r8, 0.2695327996814114_r8, 0.2772452556464864_r8, 0.2843425114885985_r8, 0.2906597857277424_r8,&
                 0.2960071117496997_r8, 0.3001659886776721_r8, 0.302885610008119_r8, 0.3038786180077924_r8, 0.3028163255331611_r8,&
                 0.299323339829651_r8, 0.2929715149035437_r8, 0.2832731501298948_r8, 0.2696733427488229_r8, 0.2515413906792607_r8,&
                 0.2281611294972407_r8, 0.1987200733208144_r8, 0.1622972135317635_r8, 0.1178493115391018_r8, 0.06419550191988976_r8,&
                 0._r8/)

  eta_face_b = (/0._r8, 0._r8, 0._r8, 0._r8, 0._r8,&
                 0._r8, 0._r8, 0._r8, 0._r8, 0._r8,&
                 0._r8, 0._r8, 0.01254074813198438_r8, 0.01568515147901569_r8, 0.01939668757548295_r8,&
                 0.02375477661820929_r8, 0.02884906434573413_r8, 0.03478069335699107_r8, 0.0416637300061256_r8, 0.04962676577066524_r8,&
                 0.05881471427746436_r8, 0.06939082773441382_r8, 0.08153895938918876_r8, 0.09546610185670711_r8, 0.111405234766373_r8,&
                 0.1296185192255581_r8, 0.1504008811297395_r8, 0.1740840304312517_r8, 0.2010409691738044_r8, 0.231691047482839_r8,&
                 0.2665056338554453_r8, 0.3060144741109534_r8, 0.3508128223486922_r8, 0.4015694373296012_r8, 0.4590355489842755_r8,&
                 0.5240549123983681_r8, 0.5975750808014414_r8, 0.6806600449716177_r8, 0.7745044042722101_r8, 0.8804492544892654_r8,&
                 1._r8/)
#endif

#ifdef DCMIP_SUPERCELL
    eta_face_a = (/0.057_r8, 0._r8, 0._r8, 0._r8, 0._r8,&
                   0._r8,   0._r8, 0._r8, 0._r8, 0._r8,&
                   0._r8,   0._r8, 0._r8, 0._r8, 0._r8,&
                   0._r8,   0._r8, 0._r8, 0._r8, 0._r8,&
                   0._r8,   0._r8, 0._r8, 0._r8, 0._r8,&
                   0._r8,   0._r8, 0._r8, 0._r8, 0._r8,&
                   0._r8,   0._r8, 0._r8, 0._r8, 0._r8,&
                   0._r8,   0._r8, 0._r8, 0._r8, 0._r8,&
                   0._r8/)

     eta_face_b = (/0._r8, 0.06248079284022309_r8, 0.06755139693833649_r8, 0.07303699379562677_r8, 0.07897122328486629_r8,&
                    0.08539048592025346_r8, 0.09233447335629152_r8, 0.09984679508407589_r8, 0.1079755672798852_r8,  0.1167737594754914_r8 ,&
                    0.1262990548055231_r8,  0.1366129959426492_r8,  0.147779280623066_r8,   0.1598612420860365_r8,  0.1729187827592224_r8 ,&
                    0.1870052794327487_r8,  0.202165174716228_r8,   0.218433027155883_r8,   0.2358346329860394_r8,  0.2543904208596746_r8 ,&
                    0.274120702801552_r8,   0.2950516888201477_r8,  0.3172206741605467_r8,  0.3406787412918951_r8,  0.3654898512779279_r8 ,&
                    0.3917263053646801_r8,  0.4194619552489941_r8,  0.4487657119579508_r8,  0.4796982246193802_r8,  0.5123135878076863_r8 ,&
                    0.5466655832888226_r8,  0.582815053642453_r8,   0.6208331654816197_r8,  0.6607964896256573_r8,  0.702775002191837_r8  ,&
                    0.7468706240220312_r8,  0.7931839904227076_r8,  0.8416035805057623_r8,  0.892074469901607_r8,   0.9447907205794289_r8 ,&
                    1._r8/)

#endif

     case(55)
     eta_face_a = (/ 0.002000000094994903_r8, 0.02014545537531376_r8, 0.03829091042280197_r8, 0.05643636360764503_r8, 0.0745818167924881_r8, &
                     0.09272727370262146_r8, 0.1108727306127548_r8, 0.1290181875228882_r8, 0.1471636295318604_r8, 0.1653090864419937_r8, &
                     0.1834545433521271_r8, 0.2015912098593803_r8, 0.2184232772595396_r8, 0.2330831237365825_r8, 0.2456547661145652_r8, &
                     0.2562222133394111_r8, 0.2648695058695753_r8, 0.2716806320323039_r8, 0.2767396242009325_r8, 0.2801305032378765_r8, &
                     0.2819372747367647_r8, 0.2822439615485794_r8, 0.2811345793979719_r8, 0.2786931415568632_r8, 0.2750036727770048_r8, &
                     0.2701501867365139_r8, 0.2642166894663137_r8, 0.2572872171889488_r8, 0.249445777640155_r8, 0.2407763576917048_r8, &
                     0.2313630311455617_r8, 0.221289787455183_r8, 0.2106406432376396_r8, 0.1994996151100027_r8, 0.1879506811753202_r8, &
                     0.1760779341529064_r8, 0.1639653533475923_r8, 0.1516969553764492_r8, 0.139356756856548_r8, 0.1270287340217231_r8, &
                     0.1147969847096173_r8, 0.1027454849759468_r8, 0.09095825143778269_r8, 0.07951930071219593_r8, 0.06851261406331899_r8, &
                     0.05802228064810011_r8, 0.04813228017265136_r8, 0.03892662925404555_r8, 0.03048931814830103_r8, 0.02290441913251251_r8, &
                     0.01625591980075924_r8, 0.01062783677011203_r8, 0.006104186657643229_r8, 0.0027689771687891_r8, 0.0007062470617089645_r8, 0._r8/)

     eta_face_b =(/0._r8, 0._r8, 0._r8, 0._r8, 0._r8, &
                   0._r8, 0._r8, 0._r8, 0._r8, 0._r8, &
                   0._r8, 8.790402880154424e-06_r8, 0.001322179912854167_r8, 0.004807790345944647_r8, 0.01038160487809531_r8, &
                   0.01795959966222155_r8, 0.02745777894335195_r8, 0.03879209478959551_r8, 0.05187854462993909_r8, 0.06663313740428968_r8, &
                   0.08297180791437367_r8, 0.1008105929138535_r8, 0.1200654170734331_r8, 0.1406523267258364_r8, 0.162487237514667_r8, &
                   0.1854861655641301_r8, 0.2095651346456248_r8, 0.2346400489319618_r8, 0.2606269304897278_r8, 0.287441852051795_r8, &
                   0.3150006206069102_r8, 0.3432193063062611_r8, 0.3720138925327767_r8, 0.4013003626693857_r8, 0.4309947982176852_r8, &
                   0.4610129872490711_r8, 0.4912710100633574_r8, 0.5216848500434726_r8, 0.552170490572346_r8, 0.5826440150207879_r8, &
                   0.6130212063418659_r8, 0.6432181480845085_r8, 0.6731508236316448_r8, 0.7027352163662037_r8, 0.7318874046286976_r8, &
                   0.7605231800528887_r8, 0.7885586225373096_r8, 0.8159097154648876_r8, 0.842492528184249_r8, 0.8682228692090097_r8, &
                   0.8930168105497351_r8, 0.9167903355893545_r8, 0.9394594277107955_r8, 0.9609401388132666_r8, 0.9811483109293189_r8, 1._r8 /)

     case(64)

    eta_face_a = &
(/2.255239523947239E-003_r8 ,  2.909090909090E-3_r8,  3.643465694040060E-003_r8, 4.343465694040060E-3_r8, 5.031691864132881E-003_r8, &
  5.723676889898889E-003_r8 ,  6.522990990999E-3_r8,  7.594819646328688E-003_r8 ,1.015794742852449E-002_r8 , 1.435663225129247E-002_r8 ,  &
  1.855531707406044E-002_r8, &
  2.461222000420094E-002_r8 ,  3.066912293434143E-002_r8 ,  3.826829977333546E-002_r8 , 4.586747661232948E-002_r8 ,  5.459547974169254E-002_r8, &
  6.332348287105560E-002_r8 ,  7.201245054602623E-002_r8 ,  8.070141822099686E-002_r8 , 8.782123029232025E-002_r8 ,  9.494104236364365E-002_r8, &
  0.103317126631737_r8      ,  0.111693210899830_r8      ,  0.121547240763903_r8      , 0.131401270627975_r8      ,  0.142994038760662_r8     , &
  0.154586806893349_r8      ,  0.168225079774857_r8      ,  0.181863352656364_r8      , 0.178230673074722_r8      ,  0.174597993493080_r8     , &
  0.170324325561523_r8      ,  0.166050657629967_r8      ,  0.161022908985615_r8      , 0.155995160341263_r8      ,  0.150080285966396_r8     , &
  0.144165411591530_r8      ,  0.137206859886646_r8      ,  0.130248308181763_r8      , 0.122061938047409_r8      ,  0.113875567913055_r8     , &
  0.104244712740183_r8      ,  9.461385756731033E-002_r8 ,  8.497915416955948E-002_r8 , 7.534445077180862E-002_r8 ,  6.650169566273689E-002_r8, &
  5.765894055366516E-002_r8 ,  5.019678920507431E-002_r8 ,  4.273463785648346E-002_r8 , 3.718865849077702E-002_r8 ,  3.164267912507057E-002_r8, &
  2.843194827437401E-002_r8 ,  2.522121742367744E-002_r8 ,  2.220897749066353E-002_r8 , 1.919673755764961E-002_r8 ,  1.640738220885396E-002_r8, &
  1.361802686005831E-002_r8 ,  1.107455790042877E-002_r8 ,  8.531088940799236E-003_r8 , 6.254953565075994E-003_r8 ,  3.978818189352751E-003_r8, &
  1.989409094676375E-003_r8 ,  0.000000000000000E+000_r8 ,  0.000000000000000E+000_r8 , 0.000000000000000E+000_r8 /)

eta_face_b = &
(/0.000000000000000_r8 ,  0.000000000000000_r8, 0.000000000000000_r8 , 0.000000000000000_r8, &
  0.000000000000000_r8 ,  0.000000000000000_r8, &
  0.000000000000000_r8 ,  0.000000000000000_r8 ,  0.000000000000000_r8 , 0.000000000000000_r8 ,  0.000000000000000_r8, &
  0.000000000000000_r8 ,  0.000000000000000_r8 ,  0.000000000000000_r8 , 0.000000000000000_r8 ,  0.000000000000000_r8, &
  0.000000000000000_r8 ,  0.000000000000000_r8 ,  0.000000000000000_r8 , 0.000000000000000_r8 ,  0.000000000000000_r8, &
  0.000000000000000_r8 ,  0.000000000000000_r8 ,  0.000000000000000_r8 , 0.000000000000000_r8 ,  0.000000000000000_r8, &
  0.000000000000000_r8 ,  0.000000000000000_r8 ,  0.000000000000000_r8 , 1.967741362750530E-002_r8 ,  3.935482725501060E-002_r8, &
  6.250429339706898E-002_r8 ,  8.565375953912735E-002_r8 ,  0.112887907773256_r8  , 0.140122056007385_r8  ,  0.172161616384983_r8 , &
  0.204201176762581_r8      ,  0.241894043982029_r8      ,  0.279586911201477_r8  , 0.323930636048317_r8  ,  0.368274360895157_r8 , &
  0.420442461967468_r8      ,  0.472610563039780_r8      ,  0.524799540638924_r8  , 0.576988518238068_r8  ,  0.624887734651566_r8 , &
  0.672786951065063_r8      ,  0.713207691907883_r8      ,  0.753628432750702_r8  , 0.783669710159302_r8  ,  0.813710987567902_r8 , &
  0.831102818250656_r8      ,  0.848494648933411_r8      ,  0.864811271429062_r8  , 0.881127893924713_r8  ,  0.896237164735794_r8 , &
  0.911346435546875_r8      ,  0.925123840570450_r8      ,  0.938901245594025_r8  , 0.951230525970459_r8  ,  0.963559806346893_r8 , &
  0.974335998296738_r8      ,  0.985112190246582_r8      ,  0.992556095123291_r8  , 1.00000000000000_r8      /)

     case(60)

! Default for real-case, EC-L60
eta_face_a = (/2.000000_r8,    20.000000_r8,   38.425343_r8,    63.647804_r8,    95.636963_r8,   134.483307_r8,  180.584351_r8,  234.779053_r8,  298.495789_r8,  373.971924_r8,  &  
               464.618134_r8,  575.651001_r8,  713.218079_r8,   883.660522_r8,   1094.834717_r8, 1356.474609_r8, 1680.640259_r8, 2082.273926_r8, 2579.888672_r8, 3196.421631_r8, &  
               3960.291504_r8, 4906.708496_r8, 6018.019531_r8,  7306.631348_r8,  8765.053711_r8, 10376.12695_r8, 12077.44628_r8, 13775.32519_r8, 15379.80566_r8, 16819.474609_r8,&
               18045.183594_r8,19027.695313_r8,19755.109375_r8, 20222.205078_r8, 20429.863281_r8,20384.480469_r8,20097.402344_r8,19584.330078_r8,18864.750000_r8,17961.357422_r8,&
               16899.468750_r8,15706.447266_r8,14411.124023_r8, 13043.218750_r8, 11632.758789_r8,10209.500977_r8,8802.356445_r8, 7438.803223_r8, 6144.314941_r8, 4941.778320_r8, &  
               3850.913330_r8, 2887.696533_r8, 2063.779785_r8,  1385.912598_r8,  855.361755_r8,  467.333588_r8,  210.393890_r8,  65.889244_r8,   7.367743_r8,    0.000000_r8,    &
               0.000000_r8/) ! Pa
eta_face_a = eta_face_a/p0

eta_face_b = (/0.000000_r8,0.000000_r8,0.000000_r8,0.000000_r8,0.000000_r8,0.000000_r8,0.000000_r8,0.000000_r8,0.000000_r8,0.000000_r8,&    
               0.000000_r8,0.000000_r8,0.000000_r8,0.000000_r8,0.000000_r8,0.000000_r8,0.000000_r8,0.000000_r8,0.000000_r8,0.000000_r8,&    
               0.000000_r8,0.000000_r8,0.000000_r8,0.000000_r8,0.000076_r8,0.000461_r8,0.001815_r8,0.005081_r8,0.011143_r8,0.020678_r8,&    
               0.034121_r8,0.051690_r8,0.073534_r8,0.099675_r8,0.130023_r8,0.164384_r8,0.202476_r8,0.243933_r8,0.288323_r8,0.335155_r8,&    
               0.383892_r8,0.433963_r8,0.484772_r8,0.535710_r8,0.586168_r8,0.635547_r8,0.683269_r8,0.728786_r8,0.771597_r8,0.811253_r8,&    
               0.847375_r8,0.879657_r8,0.907884_r8,0.931940_r8,0.951822_r8,0.967645_r8,0.979663_r8,0.988270_r8,0.994019_r8,0.997630_r8,&    
               1.000000_r8/)


! extended from CAM-L30/31, tested for G6-L60
    eta_face_a = &
(/2.255239523947239E-003_r8 ,  3.643465694040060E-003_r8, &
  5.031691864132881E-003_r8 ,  7.594819646328688E-003_r8 ,  1.015794742852449E-002_r8 , 1.435663225129247E-002_r8 ,  1.855531707406044E-002_r8, &
  2.461222000420094E-002_r8 ,  3.066912293434143E-002_r8 ,  3.826829977333546E-002_r8 , 4.586747661232948E-002_r8 ,  5.459547974169254E-002_r8, &
  6.332348287105560E-002_r8 ,  7.201245054602623E-002_r8 ,  8.070141822099686E-002_r8 , 8.782123029232025E-002_r8 ,  9.494104236364365E-002_r8, &
  0.103317126631737_r8      ,  0.111693210899830_r8      ,  0.121547240763903_r8      , 0.131401270627975_r8      ,  0.142994038760662_r8     , &
  0.154586806893349_r8      ,  0.168225079774857_r8      ,  0.181863352656364_r8      , 0.178230673074722_r8      ,  0.174597993493080_r8     , &
  0.170324325561523_r8      ,  0.166050657629967_r8      ,  0.161022908985615_r8      , 0.155995160341263_r8      ,  0.150080285966396_r8     , &
  0.144165411591530_r8      ,  0.137206859886646_r8      ,  0.130248308181763_r8      , 0.122061938047409_r8      ,  0.113875567913055_r8     , &
  0.104244712740183_r8      ,  9.461385756731033E-002_r8 ,  8.497915416955948E-002_r8 , 7.534445077180862E-002_r8 ,  6.650169566273689E-002_r8, &
  5.765894055366516E-002_r8 ,  5.019678920507431E-002_r8 ,  4.273463785648346E-002_r8 , 3.718865849077702E-002_r8 ,  3.164267912507057E-002_r8, &
  2.843194827437401E-002_r8 ,  2.522121742367744E-002_r8 ,  2.220897749066353E-002_r8 , 1.919673755764961E-002_r8 ,  1.640738220885396E-002_r8, &
  1.361802686005831E-002_r8 ,  1.107455790042877E-002_r8 ,  8.531088940799236E-003_r8 , 6.254953565075994E-003_r8 ,  3.978818189352751E-003_r8, &
  1.989409094676375E-003_r8 ,  0.000000000000000E+000_r8 ,  0.000000000000000E+000_r8 , 0.000000000000000E+000_r8 /)

eta_face_b = &
(/0.000000000000000_r8 ,  0.000000000000000_r8, &
  0.000000000000000_r8 ,  0.000000000000000_r8 ,  0.000000000000000_r8 , 0.000000000000000_r8 ,  0.000000000000000_r8, &
  0.000000000000000_r8 ,  0.000000000000000_r8 ,  0.000000000000000_r8 , 0.000000000000000_r8 ,  0.000000000000000_r8, &
  0.000000000000000_r8 ,  0.000000000000000_r8 ,  0.000000000000000_r8 , 0.000000000000000_r8 ,  0.000000000000000_r8, &
  0.000000000000000_r8 ,  0.000000000000000_r8 ,  0.000000000000000_r8 , 0.000000000000000_r8 ,  0.000000000000000_r8, &
  0.000000000000000_r8 ,  0.000000000000000_r8 ,  0.000000000000000_r8 , 1.967741362750530E-002_r8 ,  3.935482725501060E-002_r8, &
  6.250429339706898E-002_r8 ,  8.565375953912735E-002_r8 ,  0.112887907773256_r8  , 0.140122056007385_r8  ,  0.172161616384983_r8 , &
  0.204201176762581_r8      ,  0.241894043982029_r8      ,  0.279586911201477_r8  , 0.323930636048317_r8  ,  0.368274360895157_r8 , &
  0.420442461967468_r8      ,  0.472610563039780_r8      ,  0.524799540638924_r8  , 0.576988518238068_r8  ,  0.624887734651566_r8 , &
  0.672786951065063_r8      ,  0.713207691907883_r8      ,  0.753628432750702_r8  , 0.783669710159302_r8  ,  0.813710987567902_r8 , &
  0.831102818250656_r8      ,  0.848494648933411_r8      ,  0.864811271429062_r8  , 0.881127893924713_r8  ,  0.896237164735794_r8 , &
  0.911346435546875_r8      ,  0.925123840570450_r8      ,  0.938901245594025_r8  , 0.951230525970459_r8  ,  0.963559806346893_r8 , &
  0.974335998296738_r8      ,  0.985112190246582_r8      ,  0.992556095123291_r8  , 1.00000000000000_r8      /)

#ifdef DCMIP21
#ifdef FLAT_DCMIP21
  eta_face_a = (/0.03281792304784018_r8, 0.03474102071194446_r8, 0.03677680998728482_r8, 0.03893189449024544_r8, 0.04121326480256544_r8,&
    0.04362832114712411_r8, 0.04618489739250437_r8, 0.04889128646419994_r8, 0.05175626724489389_r8, 0.0547891330510669_r8 ,&
    0.05799972177830628_r8, 0.06139844781310023_r8, 0.06499633581463152_r8, 0.06880505647615068_r8, 0.07283696438193012_r8,&
    0.07710513808259807_r8, 0.08162342251884733_r8, 0.08640647393113107_r8, 0.09146980740102234_r8, 0.09682984717844971_r8,&
    0.1025039799580591_r8,  0.1085106112775176_r8,  0.1148692252207011_r8,  0.1216004476194305_r8,  0.1287261129587656_r8 ,&
    0.1350456081805054_r8,  0.1427250473547907_r8,  0.1508030763969775_r8,  0.1592924802031636_r8,  0.1682047034916206_r8 ,&
    0.1775493685725172_r8,  0.1873336879076161_r8,  0.1975617507483634_r8,  0.2082336591917547_r8,  0.219344484300267_r8  ,&
    0.2308830073555085_r8,  0.2428302046894931_r8,  0.2551574266661043_r8,  0.267824212035116_r8,   0.2807756677752939_r8 ,&
    0.2939393313530507_r8,  0.3072214166589859_r8,  0.3205023262836642_r8,  0.3336312907070463_r8,  0.346419968751406_r8  ,&
    0.3586348125120132_r8,  0.3699879630156528_r8,  0.3801263989752005_r8,  0.388619008916789_r8,   0.3949411951212309_r8 ,&
    0.3984565444238701_r8,  0.398395013798003_r8,   0.3938269752447859_r8,  0.3836323417875858_r8,  0.3664638507145668_r8 ,&
    0.3407034073507749_r8,  0.3044101874928628_r8,  0.2552589531818032_r8,  0.1904667475740021_r8,  0.106705791818907_r8  ,&
    0._r8/)

    eta_face_b = (/0._r8, 0._r8, 0._r8, 0._r8, 0._r8,&
    0._r8, 0._r8, 0._r8, 0._r8, 0._r8,&
    0._r8, 0._r8, 0._r8, 0._r8, 0._r8,&
    0._r8, 0._r8, 0._r8, 0._r8, 0._r8,&
    0._r8, 0._r8, 0._r8, 0._r8, 0._r8,&
    0.001223727022378311_r8, 0.001529535416493121_r8, 0.001904681511544389_r8, 0.002363800501769887_r8, 0.002924474549267209_r8,&
    0.003607809170569179_r8, 0.004439120350710344_r8, 0.005448753419685578_r8, 0.006673058694179184_r8, 0.008155553600595522_r8,&
    0.00994830659329325_r8,  0.01211358483014104_r8,  0.0147258154626543_r8,   0.01787391977334953_r8,  0.0216640905254665_r8  ,&
    0.02622309610847879_r8,  0.03170221075683934_r8,  0.03828188875201099_r8,  0.04617732263825928_r8,  0.05564505174270933_r8 ,&
    0.06699081846324466_r8,  0.08057890679175883_r8,  0.09684324146417017_r8,  0.1163005782648078_r8,   0.1395661778947692_r8  ,&
    0.1673724292612262_r8,   0.200590975216494_r8,    0.2402589972338011_r8,   0.2876104382908383_r8,   0.3441130889489694_r8  ,&
    0.4115126345448339_r8,   0.491884966629393_r8,    0.587698305321578_r8,    0.7018869682373099_r8,   0.8379389645902481_r8  ,&
    1._r8/)
#else

  eta_face_a = (/0.03281792304784018_r8,  0.03275266949046148_r8,  0.03268359213949332_r8,  0.03261046692443285_r8,  0.03253305664446852_r8 ,&
    0.03245111019905704_r8,  0.0323643617734129_r8,   0.03227252997626845_r8,  0.03217531692710748_r8,  0.0320724072899117_r8  ,&
    0.03196346725028562_r8,  0.03184814343264206_r8,  0.03172606175393571_r8,  0.03159682621022677_r8,  0.03146001759213821_r8 ,&
    0.03131519212504029_r8,  0.03116188002955114_r8,  0.03099958399768418_r8,  0.03082777757969917_r8,  0.03064590347642454_r8 ,&
    0.03045337173151126_r8,  0.03024955781775478_r8,  0.03003380061127726_r8,  0.02980540024699889_r8,  0.0295636158484419_r8  ,&
    0.02930766312450359_r8,  0.02903671182540225_r8,  0.02874988304954446_r8,  0.02844624639257712_r8,  0.02812481692937707_r8 ,&
    0.02778455201918809_r8,  0.02742434792354223_r8,  0.02704303622599455_r8,  0.02663938004205813_r8,  0.02621207000704476_r8 ,&
    0.02575972002879715_r8,  0.02528086279153569_r8,  0.02477394499623484_r8,  0.02423732232209036_r8,  0.02366925409273357_r8 ,&
    0.02306789762989125_r8,  0.02243130227617518_r8,  0.02175740306761348_r8,  0.02104401403539846_r8,  0.02028882111512359_r8 ,&
    0.01948937464050854_r8,  0.01864308139726439_r8,  0.01774719621132309_r8,  0.01679881304414516_r8,  0.01579485556622184_r8 ,&
    0.01473206717819386_r8,  0.01360700044721663_r8,  0.01241600592430847_r8,  0.01115522030640548_r8,  0.009820553904724916_r8,&
    0.008407677378787226_r8, 0.006912007693064992_r8, 0.005328693250705063_r8, 0.003652598156101972_r8, 0.001878285555273584_r8,&
    0._r8/)

  eta_face_b = (/0._r8,                  0.001988351221482984_r8,0.004093217847791509_r8,0.006321427565812587_r8,0.008680208158096921_r8,&
    0.01117721094806707_r8, 0.01382053561909147_r8, 0.01661875648793149_r8, 0.0195809503177864_r8,  0.0227167257611552_r8  ,&
    0.02603625452802066_r8, 0.02955030438045817_r8, 0.03327027406069581_r8, 0.0372082302659239_r8,  0.0413769467897919_r8  ,&
    0.04578994595755778_r8, 0.05046154248929619_r8, 0.0554068899334469_r8,  0.06064202982132317_r8, 0.06618394370202517_r8 ,&
    0.07205060822654788_r8, 0.07826105345976282_r8, 0.08483542460942388_r8, 0.0917950473724316_r8,  0.09916249711032367_r8 ,&
    0.1069616720783801_r8,  0.1152178709458816_r8,  0.1239578748589774_r8,  0.1332100343123563_r8,  0.1430043611115107_r8  ,&
    0.1533726257238983_r8,  0.1643484603347842_r8,  0.1759674679420545_r8,  0.1882673378438758_r8,  0.2012879678938178_r8  ,&
    0.2150715939200046_r8,  0.2296629267280985_r8,  0.2451092971325237_r8,  0.2614608094863751_r8,  0.2787705042080268_r8  ,&
    0.2970945298316382_r8,  0.3164923251396501_r8,  0.3370268119680617_r8,  0.3587645993099071_r8,  0.3817761993789918_r8  ,&
    0.4061362563347494_r8,  0.4319237884101472_r8,  0.4592224442280476_r8,  0.4881207741374516_r8,  0.5187125174497783_r8  ,&
    0.5510969065069025_r8,  0.5853789885672804_r8,  0.6216699665542785_r8,  0.6600875597720186_r8,  0.7007563857588113_r8  ,&
    0.7438083645168215_r8,  0.7893831464291908_r8,  0.8376285652526761_r8,  0.88870111765521_r8,    0.9427664708538815_r8  ,&
    1._r8/)
#endif
#endif


#ifdef DCMIP1

    eta_face_a = (/0.2549437895196341_r8, 0.252933857641943_r8, 0.2508776170373553_r8, 0.2487740007551893_r8, 0.2466219172622748_r8,&
                   0.2444202498765736_r8, 0.2421678561877506_r8, 0.2398635674643959_r8, 0.2375061880475876_r8, 0.2350944947304842_r8,&
                   0.2326272361236217_r8, 0.2301031320055869_r8, 0.2275208726587316_r8, 0.2248791181895803_r8, 0.222176497833581_r8,&
                   0.2194116092438368_r8, 0.2165830177634507_r8, 0.2136892556811047_r8, 0.2107288214694878_r8, 0.207700179006177_r8,&
                   0.2046017567765677_r8, 0.2014319470584399_r8, 0.1981891050877367_r8, 0.1948715482051216_r8, 0.1914775549828742_r8,&
                   0.1880053643316679_r8, 0.1844531745867685_r8, 0.1808191425731797_r8, 0.1771013826492478_r8, 0.1732979657282328_r8,&
                   0.1694069182773354_r8, 0.1654262212936626_r8, 0.1613538092565985_r8, 0.1571875690560389_r8, 0.1529253388959313_r8,&
                   0.1485649071725539_r8, 0.1441040113269489_r8, 0.1395403366709169_r8, 0.1348715151859615_r8, 0.130095124294562_r8,&
                   0.1252086856031369_r8, 0.1202096636160439_r8, 0.1150954644199518_r8, 0.1098634343379_r8, 0.1045108585523475_r8,&
                   0.099034959696497_r8, 0.0934328964131631_r8, 0.08770176188043766_r8, 0.08183858230338514_r8, 0.07584031537098834_r8,&
                   0.06970384867754043_r8, 0.06342599810766802_r8, 0.05700350618414329_r8, 0.05043304037763086_r8, 0.04371119137749158_r8,&
                   0.03683447132274431_r8, 0.02979931199227104_r8, 0.0226020629533229_r8, 0.01523898966736859_r8, 0.007706271552301414_r8,&
                   0._r8/)

    eta_face_b = (/0._r8, 0.007883823651787022_r8, 0.01594929019428304_r8, 0.02420058467033059_r8, 0.03264198854594341_r8,&
                   0.04127788193189189_r8, 0.05011274585647277_r8, 0.05915116459064369_r8, 0.06839782802672914_r8, 0.07785753411193111_r8,&
                   0.08753519133790777_r8, 0.09743582128771239_r8, 0.1075645612414127_r8, 0.1179266668417447_r8, 0.1285275148211823_r8,&
                   0.1393726057918384_r8, 0.1504675670996456_r8, 0.1618181557442969_r8, 0.1734302613664615_r8, 0.1853099093038263_r8,&
                   0.1974632637175477_r8, 0.2098966307907379_r8, 0.2226164620006428_r8, 0.2356293574662117_r8, 0.2489420693727946_r8,&
                   0.2625615054757438_r8, 0.276494732684739_r8, 0.2907489807306948_r8, 0.3053316459171539_r8, 0.3202502949581109_r8,&
                   0.3355126689042613_r8, 0.3511266871597099_r8, 0.3671004515912238_r8, 0.3834422507321628_r8, 0.4001605640832684_r8,&
                   0.4172640665125424_r8, 0.4347616327564984_r8, 0.4526623420251215_r8, 0.4709754827129273_r8, 0.489710557218563_r8,&
                   0.5088772868754501_r8, 0.5284856169960316_r8, 0.5485457220322371_r8, 0.5690680108548435_r8, 0.5900631321544754_r8,&
                   0.6115419799670392_r8, 0.6335156993264686_r8, 0.6559956920477036_r8, 0.6789936226429141_r8, 0.7025214243740282_r8,&
                   0.7265913054447154_r8, 0.751215755335027_r8, 0.7764075512819926_r8, 0.8021797649095239_r8, 0.8285457690110736_r8,&
                   0.8555192444885676_r8, 0.8831141874512063_r8, 0.9113449164778251_r8, 0.9402260800465783_r8, 0.9697726641358018_r8,&
                   1._r8/)
#ifdef CC25
      eta_face_a = (/0.2549437895196341_r8, 0.2608121625242594_r8, 0.2667947814724166_r8, 0.2728834757193685_r8, 0.2790714010271608_r8,&
                     0.2853519585538281_r8, 0.2917184283758433_r8, 0.2981637738130677_r8,0.3046805109931729_r8, 0.3112606082573158_r8,&
                     0.3178954003524245_r8, 0.3245755099713536_r8, 0.3312907725389073_r8,0.3380301617711479_r8, 0.3447817143964536_r8,&
                     0.3515324529092424_r8, 0.3582683055093559_r8, 0.3649740225497128_r8,0.3716330889181428_r8, 0.378227631841744_r8,&
                     0.3847383236383473_r8, 0.3911442789584691_r8, 0.3974229460678784_r8,0.4035499917189946_r8, 0.4094991791509601_r8,&
                     0.4152422387448256_r8, 0.4207487308427941_r8, 0.4259859002195167_r8,0.4309185216694272_r8, 0.4355087361473088_r8,&
                     0.4397158768698611_r8, 0.4434962847540571_r8, 0.4468031125335874_r8,0.449586116857654_r8, 0.4517914376367599_r8,&
                     0.453361363857873_r8, 0.4542340850463136_r8, 0.4543434275038296_r8,0.4536185744014355_r8, 0.4519837687515585_r8,&
                     0.4493579982267037_r8, 0.4456546607310292_r8, 0.4407812095667398_r8,0.4346387769688497_r8, 0.4271217747094092_r8,&
                     0.4181174703955278_r8, 0.4075055380041708_r8, 0.3951575811105438_r8,0.3809366271755756_r8, 0.3646965911613254_r8,&
                     0.3462817066407035_r8, 0.3255259224594244_r8, 0.3022522628932044_r8,0.2762721491215466_r8, 0.2473846797105826_r8,&
                     0.2153758676609635_r8, 0.1800178314322861_r8, 0.1410679372024696_r8,0.09826788945844644_r8, 0.05134276684289407_r8,&
                     0._r8/)

   eta_face_b = (/0._r8, 5.518769470670381e-06_r8, 3.212575922168272e-05_r8,9.110970615138034e-05_r8, 0.0001925047810574828_r8,&
                  0.0003461732546374205_r8, 0.000562173668380122_r8, 0.0008509582419717733_r8, 0.001223505081143744_r8, 0.001691420585099595_r8,&
                  0.002267027109104939_r8, 0.002963443321945639_r8, 0.003794661361237022_r8,0.004775623260177175_r8, 0.005922298258309746_r8,&
                  0.007251762126432755_r8, 0.008782279353740376_r8, 0.01053338887568885_r8,0.01252599391780657_r8, 0.01478245646825926_r8,&
                  0.01732669685576809_r8, 0.0201842988907087_r8, 0.02338262102050101_r8,0.02695091395233874_r8, 0.03092044520470873_r8,&
                  0.03532463106258604_r8, 0.04019917642871342_r8, 0.04558222308435782_r8,0.05151450689697452_r8, 0.05803952453903486_r8,&
                  0.06520371031173569_r8, 0.07305662369931548_r8, 0.08165114831423491_r8,0.09104370293054771_r8, 0.1012944653424398_r8,&
                  0.1124676098272233_r8, 0.1246315590371337_r8, 0.1378592511922087_r8,0.1522284234974534_r8, 0.1678219127615666_r8,&
                  0.1847279742518833_r8, 0.2030406198810463_r8, 0.222859976885449_r8,0.2442926682238939_r8, 0.2674522159974137_r8,&
                  0.2924594692680084_r8, 0.3194430577354608_r8, 0.3485398728175974_r8,0.3798955777707236_r8, 0.4136651485836911_r8,&
                  0.4500134474815523_r8, 0.4891158309832707_r8, 0.5311587945729315_r8,0.5763406561656081_r8, 0.6248722806779825_r8,&
                  0.6769778481503484_r8, 0.7328956680111912_r8, 0.7928790422286784_r8,0.8571971802555004_r8, 0.9261361688452091_r8,&
                  1._r8/)
#endif

#endif

    case(51)
! below 2.25 hPa is CAM-L30/31 (31 face)
! above 2.25 hPa equival distance with top at 2.25 Pa, 21 face
     eta_face_a = (/2.255239e-05_r8, 0.0001288708_r8, 0.0002351893_r8, 0.0003415077_r8, 0.0004478261_r8, 0.0005541446_r8, 0.000660463_r8, &
                    0.0007667814_r8, 0.0008730999_r8, 0.0009794183_r8, 0.001085737_r8,  0.001192055_r8,  0.001298374_r8,  0.001404692_r8, &
                    0.00151101_r8,   0.001617329_r8,  0.001723647_r8,  0.001829966_r8,  0.001936284_r8,  0.002042603_r8,  0.002148921_r8, & ! above 2.25 hPa
                    0.002255239523947239_r8, 0.005031691864132881_r8, 0.01015794742852449_r8, 0.01855531707406044_r8, &
                    0.03066912293434143_r8 , 0.04586747661232948_r8,  0.0633234828710556_r8,  0.08070141822099686_r8, &
                    0.09494104236364365_r8 , 0.1116932108998299_r8,   0.1314012706279755_r8,  0.1545868068933487_r8 , &
                    0.1818633526563644_r8  , 0.1745979934930801_r8,   0.1660506576299667_r8,  0.1559951603412628_r8 , &
                    0.1441654115915298_r8  , 0.1302483081817627_r8,   0.1138755679130554_r8,  0.09461385756731033_r8, &
                    0.07534445077180862_r8 , 0.05765894055366516_r8,  0.04273463785648346_r8, 0.03164267912507057_r8, &
                    0.02522121742367744_r8 , 0.01919673755764961_r8,  0.01361802686005831_r8, 0.008531088940799236_r8,&
                    0.003978818189352751_r8, zero , zero/)

     eta_face_b = (/zero, zero, zero, zero, zero, zero, zero, zero, zero, zero, zero, zero, zero, zero, zero, zero, zero, zero, zero, zero, zero, & ! above 2.25
                    zero, zero, zero, zero, zero, zero, zero, zero, zero, zero, zero, zero, zero, &
                    0.0393548272550106_r8, 0.08565375953912735_r8, 0.1401220560073853_r8, 0.2042011767625809_r8, &
                    0.2795869112014771_r8, 0.3682743608951569_r8,  0.4726105630397797_r8, 0.5769885182380676_r8, &
                    0.6727869510650635_r8, 0.7536284327507019_r8,  0.8137109875679016_r8, 0.8484946489334106_r8, &
                    0.8811278939247131_r8, 0.911346435546875_r8,   0.9389012455940247_r8, 0.9635598063468933_r8, &
                    0.985112190246582_r8 , 1._r8/)

    case(81)

! below 2.25 hPa extended from CAM-L30/31 (directly double resolution; 61 face)
! above 2.25 hPa equival distance with top at 2.25 Pa, 21 face

 eta_face_a = &
  (/2.255239e-05_r8, 0.0001288708_r8, 0.0002351893_r8, 0.0003415077_r8, 0.0004478261_r8, 0.0005541446_r8, 0.000660463_r8, 0.0007667814_r8, 0.0008730999_r8, 0.0009794183_r8, &
    0.001085737_r8, 0.001192055_r8, 0.001298374_r8, 0.001404692_r8, 0.00151101_r8, 0.001617329_r8, 0.001723647_r8, 0.001829966_r8, 0.001936284_r8, 0.002042603_r8, 0.002148921_r8, & ! abover 2.25 hPa
  2.255239523947239E-003_r8 ,  3.643465694040060E-003_r8, &
  5.031691864132881E-003_r8 ,  7.594819646328688E-003_r8 ,  1.015794742852449E-002_r8 , 1.435663225129247E-002_r8 ,  1.855531707406044E-002_r8, &
  2.461222000420094E-002_r8 ,  3.066912293434143E-002_r8 ,  3.826829977333546E-002_r8 , 4.586747661232948E-002_r8 ,  5.459547974169254E-002_r8, &
  6.332348287105560E-002_r8 ,  7.201245054602623E-002_r8 ,  8.070141822099686E-002_r8 , 8.782123029232025E-002_r8 ,  9.494104236364365E-002_r8, &
  0.103317126631737_r8      ,  0.111693210899830_r8      ,  0.121547240763903_r8      , 0.131401270627975_r8      ,  0.142994038760662_r8     , &
  0.154586806893349_r8      ,  0.168225079774857_r8      ,  0.181863352656364_r8      , 0.178230673074722_r8      ,  0.174597993493080_r8     , &
  0.170324325561523_r8      ,  0.166050657629967_r8      ,  0.161022908985615_r8      , 0.155995160341263_r8      ,  0.150080285966396_r8     , &
  0.144165411591530_r8      ,  0.137206859886646_r8      ,  0.130248308181763_r8      , 0.122061938047409_r8      ,  0.113875567913055_r8     , &
  0.104244712740183_r8      ,  9.461385756731033E-002_r8 ,  8.497915416955948E-002_r8 , 7.534445077180862E-002_r8 ,  6.650169566273689E-002_r8, &
  5.765894055366516E-002_r8 ,  5.019678920507431E-002_r8 ,  4.273463785648346E-002_r8 , 3.718865849077702E-002_r8 ,  3.164267912507057E-002_r8, &
  2.843194827437401E-002_r8 ,  2.522121742367744E-002_r8 ,  2.220897749066353E-002_r8 , 1.919673755764961E-002_r8 ,  1.640738220885396E-002_r8, &
  1.361802686005831E-002_r8 ,  1.107455790042877E-002_r8 ,  8.531088940799236E-003_r8 , 6.254953565075994E-003_r8 ,  3.978818189352751E-003_r8, &
  1.989409094676375E-003_r8 ,  0.000000000000000E+000_r8 ,  0.000000000000000E+000_r8 , 0.000000000000000E+000_r8 /)

eta_face_b = &
(/zero, zero, zero, zero, zero, zero, zero, zero, zero, zero, zero, zero, zero, zero, zero, zero, zero, zero, zero, zero, zero, & ! above 2.25
  0.000000000000000_r8 ,  0.000000000000000_r8, &
  0.000000000000000_r8 ,  0.000000000000000_r8 ,  0.000000000000000_r8 , 0.000000000000000_r8 ,  0.000000000000000_r8, &
  0.000000000000000_r8 ,  0.000000000000000_r8 ,  0.000000000000000_r8 , 0.000000000000000_r8 ,  0.000000000000000_r8, &
  0.000000000000000_r8 ,  0.000000000000000_r8 ,  0.000000000000000_r8 , 0.000000000000000_r8 ,  0.000000000000000_r8, &
  0.000000000000000_r8 ,  0.000000000000000_r8 ,  0.000000000000000_r8 , 0.000000000000000_r8 ,  0.000000000000000_r8, &
  0.000000000000000_r8 ,  0.000000000000000_r8 ,  0.000000000000000_r8 , 1.967741362750530E-002_r8 ,  3.935482725501060E-002_r8, &
  6.250429339706898E-002_r8 ,  8.565375953912735E-002_r8 ,  0.112887907773256_r8  , 0.140122056007385_r8  ,  0.172161616384983_r8 , &
  0.204201176762581_r8      ,  0.241894043982029_r8      ,  0.279586911201477_r8  , 0.323930636048317_r8  ,  0.368274360895157_r8 , &
  0.420442461967468_r8      ,  0.472610563039780_r8      ,  0.524799540638924_r8  , 0.576988518238068_r8  ,  0.624887734651566_r8 , &
  0.672786951065063_r8      ,  0.713207691907883_r8      ,  0.753628432750702_r8  , 0.783669710159302_r8  ,  0.813710987567902_r8 , &
  0.831102818250656_r8      ,  0.848494648933411_r8      ,  0.864811271429062_r8  , 0.881127893924713_r8  ,  0.896237164735794_r8 , &
  0.911346435546875_r8      ,  0.925123840570450_r8      ,  0.938901245594025_r8  , 0.951230525970459_r8  ,  0.963559806346893_r8 , &
  0.974335998296738_r8      ,  0.985112190246582_r8      ,  0.992556095123291_r8  , 1.00000000000000_r8      /)


    case(91) ! EC-L91

      eta_face_a = (/1.200000_r8,    2.000040_r8,    3.980832_r8,    7.387186_r8,    12.908319_r8,   21.413612_r8,   33.952858_r8,   51.746601_r8,   76.167656_r8,   108.715561_r8,  &
                     150.986023_r8,  204.637451_r8,  271.356506_r8,  352.824493_r8,  450.685791_r8,  566.519226_r8,  701.813354_r8,  857.945801_r8,  1036.166504_r8, 1237.585449_r8, &
                     1463.163940_r8, 1713.709595_r8, 1989.874390_r8, 2292.155518_r8, 2620.898438_r8, 2976.302246_r8, 3358.425781_r8, 3767.196045_r8, 4202.416504_r8, 4663.776367_r8, &
                     5150.859863_r8, 5663.156250_r8, 6199.839355_r8, 6759.727051_r8, 7341.469727_r8, 7942.926270_r8, 8564.624023_r8, 9208.305664_r8, 9873.560547_r8, 10558.881836_r8,&
                     11262.484375_r8,11982.662109_r8,12713.897461_r8,13453.225586_r8,14192.009766_r8,14922.685547_r8,15638.053711_r8,16329.560547_r8,16990.623047_r8,17613.281250_r8,&
                     18191.029297_r8,18716.968750_r8,19184.544922_r8,19587.513672_r8,19919.796875_r8,20175.394531_r8,20348.916016_r8,20434.158203_r8,20426.218750_r8,20319.011719_r8,&
                     20107.031250_r8,19785.357422_r8,19348.775391_r8,18798.822266_r8,18141.296875_r8,17385.595703_r8,16544.585938_r8,15633.566406_r8,14665.645508_r8,13653.219727_r8,&
                     12608.383789_r8,11543.166992_r8,10471.310547_r8,9405.222656_r8, 8356.252930_r8, 7335.164551_r8, 6353.920898_r8, 5422.802734_r8, 4550.215820_r8, 3743.464355_r8, &
                     3010.146973_r8, 2356.202637_r8, 1784.854614_r8, 1297.656128_r8, 895.193542_r8,  576.314148_r8,  336.772369_r8,  162.043427_r8,  54.208336_r8,   6.575628_r8,    &
                     0.003160_r8,    0.000000_r8/)
      eta_face_a = eta_face_a/p0

      eta_face_b = (/0.000000_r8,0.000000_r8,0.000000_r8,0.000000_r8,0.000000_r8,0.000000_r8,0.000000_r8,0.000000_r8,0.000000_r8,0.000000_r8,&
                     0.000000_r8,0.000000_r8,0.000000_r8,0.000000_r8,0.000000_r8,0.000000_r8,0.000000_r8,0.000000_r8,0.000000_r8,0.000000_r8,&
                     0.000000_r8,0.000000_r8,0.000000_r8,0.000000_r8,0.000000_r8,0.000000_r8,0.000000_r8,0.000000_r8,0.000000_r8,0.000000_r8,&
                     0.000000_r8,0.000000_r8,0.000000_r8,0.000000_r8,0.000000_r8,0.000014_r8,0.000055_r8,0.000131_r8,0.000279_r8,0.000548_r8,&
                     0.001000_r8,0.001701_r8,0.002765_r8,0.004267_r8,0.006322_r8,0.009035_r8,0.012508_r8,0.016860_r8,0.022189_r8,0.028610_r8,&
                     0.036227_r8,0.045146_r8,0.055474_r8,0.067316_r8,0.080777_r8,0.095964_r8,0.112979_r8,0.131935_r8,0.152934_r8,0.176091_r8,&
                     0.201520_r8,0.229315_r8,0.259554_r8,0.291993_r8,0.326329_r8,0.362203_r8,0.399205_r8,0.436906_r8,0.475016_r8,0.513280_r8,&
                     0.551458_r8,0.589317_r8,0.626559_r8,0.662934_r8,0.698224_r8,0.732224_r8,0.764679_r8,0.795385_r8,0.824185_r8,0.850950_r8,&
                     0.875518_r8,0.897767_r8,0.917651_r8,0.935157_r8,0.950274_r8,0.963007_r8,0.973466_r8,0.982238_r8,0.989153_r8,0.994204_r8,&
                     0.997630_r8,1.000000_r8/)

    case(120)

  eta_face_a = (/0.03281792304784018_r8, 0.03278576073169086_r8, 0.03275266949046148_r8, 0.03271862249456052_r8, 0.03268359213949332_r8,&
            0.03264755002348096_r8, 0.03261046692443285_r8, 0.03257231277625406_r8, 0.03253305664446852_r8, 0.03249266670113805_r8,&
            0.03245111019905704_r8, 0.03240835344520177_r8, 0.0323643617734129_r8,  0.03231909951628906_r8, 0.03227252997626845_r8,&
            0.0322246153958754_r8,  0.03217531692710748_r8, 0.0321245945999385_r8,  0.0320724072899117_r8,  0.03201871268479708_r8,&
            0.03196346725028562_r8, 0.03190662619469269_r8, 0.03184814343264206_r8, 0.03178797154770089_r8, 0.03172606175393571_r8,&
            0.03166236385635791_r8, 0.03159682621022677_r8, 0.03152939567917726_r8, 0.03146001759213821_r8, 0.03138863569900641_r8,&
            0.03131519212504029_r8, 0.03123962732393649_r8, 0.03116188002955114_r8, 0.0310818872062267_r8,  0.03099958399768418_r8,&
            0.03091490367443915_r8, 0.03082777757969917_r8, 0.03073813507369838_r8, 0.03064590347642454_r8, 0.03055100800869175_r8,&
            0.03045337173151126_r8, 0.03035291548371126_r8, 0.03024955781775478_r8, 0.03014321493370399_r8, 0.03003380061127726_r8,&
            0.0299212261399437_r8,  0.02980540024699889_r8, 0.02968622902356301_r8, 0.0295636158484419_r8,  0.0294374613097888_r8,&
            0.02930766312450359_r8, 0.02917411605530409_r8, 0.02903671182540225_r8, 0.02889533903071578_r8, 0.02874988304954446_r8,&
            0.02860022594963754_r8, 0.02844624639257712_r8, 0.02828781953539983_r8, 0.02812481692937707_r8, 0.02795710641587196_r8,&
            0.02778455201918809_r8, 0.02760701383632386_r8, 0.02742434792354223_r8, 0.02723640617966475_r8, 0.02704303622599455_r8,&
            0.02684408128277135_r8, 0.02663938004205813_r8, 0.02642876653695653_r8, 0.02621207000704476_r8, 0.02598911475992918_r8,&
            0.02575972002879715_r8, 0.02552369982585539_r8, 0.02528086279153569_r8, 0.02503101203934507_r8, 0.02477394499623484_r8,&
            0.02450945323835924_r8, 0.02423732232209036_r8, 0.02395733161015223_r8, 0.02366925409273357_r8, 0.02337285620343343_r8,&
            0.02306789762989125_r8, 0.02275413111894714_r8, 0.02243130227617518_r8, 0.02209914935962609_r8, 0.02175740306761348_r8,&
            0.0214057863203701_r8,  0.02104401403539846_r8, 0.02067179289633247_r8, 0.02028882111512359_r8, 0.01989478818735829_r8,&
            0.01948937464050854_r8, 0.01907225177491079_r8, 0.01864308139726439_r8, 0.01820151554643246_r8, 0.01774719621132309_r8,&
            0.01727975504062262_r8, 0.01679881304414516_r8, 0.01630398028555624_r8, 0.01579485556622184_r8, 0.01527102609992614_r8,&
            0.01473206717819386_r8, 0.01417754182594722_r8, 0.01360700044721663_r8, 0.01301998046061914_r8, 0.01241600592430847_r8,&
            0.01179458715009241_r8, 0.01115522030640548_r8, 0.0104973870098144_r8,  0.009820553904724916_r8,0.009124172230949745_r8,&
            0.008407677378787226_r8,0.007670488431248734_r8,0.006912007693064992_r8,0.006131620206089705_r8,0.005328693250705063_r8,&
            0.004502575832828537_r8,0.003652598156101972_r8,0.002778071078836541_r8,0.001878285555273584_r8,0.0009525120607065674_r8,&
            0._r8/)

  eta_face_b = (/0._r8,                  0.0009800229009751377_r8, 0.001988351221482984_r8,0.003025802490148745_r8,0.004093217847791509_r8,&
           0.00519146272940118_r8, 0.006321427565812587_r8,  0.00748402850564566_r8,0.008680208158096921_r8, 0.009910936357184616_r8,&
           0.01117721094806707_r8, 0.01248005859607182_r8,   0.01382053561909147_r8,0.01519972884402104_r8,  0.01661875648793149_r8,&
           0.01807876906469341_r8, 0.0195809503177864_r8,    0.02112651818005012_r8,0.0227167257611552_r8,   0.02435286236359487_r8,&
           0.02603625452802066_r8, 0.02776826710877012_r8,   0.02955030438045817_r8,0.03138381117652964_r8,  0.03327027406069581_r8,&
           0.03521122253220493_r8, 0.0372082302659239_r8,    0.03926291638823637_r8,0.0413769467897919_r8,   0.04355203547617054_r8,&
           0.04578994595755778_r8, 0.04809249267855661_r8,   0.05046154248929619_r8,0.05289901615902937_r8,  0.0554068899334469_r8,&
           0.05798719713697034_r8, 0.06064202982132317_r8,   0.06337354046171657_r8,0.06618394370202517_r8,  0.06907551815036758_r8,&
           0.07205060822654788_r8, 0.07511162606285503_r8,   0.07826105345976282_r8,0.08150144389811438_r8,  0.08483542460942388_r8,&
           0.0882656987059733_r8,  0.0917950473724316_r8,    0.09542633212077321_r8,0.09916249711032367_r8,  0.1030065715348143_r8,&
           0.1069616720783801_r8,  0.1110310054424936_r8,    0.1152178709458816_r8, 0.1195256631995348_r8,   0.1239578748589774_r8,&
           0.1285180994560293_r8,  0.1332100343123563_r8,    0.1380374835371702_r8, 0.1430043611115107_r8,   0.1481146940616076_r8,&
           0.1533726257238983_r8,  0.158782419104346_r8,     0.1643484603347842_r8, 0.1700752622290876_r8,   0.1759674679420545_r8,&
           0.182029854733966_r8,   0.1882673378438758_r8,    0.1946849744747679_r8, 0.2012879678938178_r8,   0.2080816716510771_r8,&
           0.2150715939200046_r8,  0.2222634019633625_r8,    0.2296629267280985_r8, 0.2372761675729383_r8,   0.2451092971325237_r8,&
           0.2531686663220377_r8,  0.2614608094863751_r8,    0.269992449698035_r8,  0.2787705042080268_r8,   0.2878020900542139_r8,&
           0.2970945298316382_r8,  0.3066553576295065_r8,    0.3164923251396501_r8, 0.326613407941413_r8,    0.3370268119680617_r8,&
           0.3477409801599605_r8,  0.3587645993099071_r8,    0.3701066071061777_r8, 0.3817761993789918_r8,   0.3937828375562729_r8,&
           0.4061362563347494_r8,  0.4188464715726145_r8,    0.4319237884101472_r8, 0.4453788096248736_r8,   0.4592224442280476_r8,&
           0.4734659163094176_r8,  0.4881207741374516_r8,    0.5031988995223988_r8, 0.5187125174497783_r8,   0.5346742059921071_r8,&
           0.5510969065069025_r8,  0.5679939341292264_r8,    0.5853789885672804_r8, 0.6032661652098037_r8,   0.6216699665542785_r8,&
           0.6406053139652111_r8,  0.6600875597720186_r8,    0.6801324997163325_r8, 0.7007563857588113_r8,   0.7219759392558426_r8,&
           0.7438083645168215_r8,  0.7662713627529969_r8,    0.7893831464291908_r8, 0.8131624540300323_r8,   0.8376285652526761_r8,&
           0.8628013166383219_r8,  0.88870111765521_r8,      0.9153489672461335_r8, 0.9427664708538815_r8,   0.970975857938418_r8           ,&
1._r8/)

#ifdef DCMIP1

eta_face_a = (/0.2549437895196341_r8, 0.2539445464322624_r8, 0.252933857641943_r8, 0.2519115920453261_r8, 0.2508776170373553_r8,&
          0.2498317984940664_r8, 0.2487740007551893_r8, 0.2477040866065507_r8, 0.2466219172622748_r8, 0.2455273523467809_r8,&
          0.2444202498765736_r8, 0.2433004662418261_r8, 0.2421678561877506_r8, 0.2410222727957574_r8, 0.2398635674643959_r8,&
          0.2386915898900793_r8, 0.2375061880475876_r8, 0.236307208170347_r8, 0.2350944947304842_r8, 0.2338678904186516_r8,&
          0.2326272361236217_r8, 0.2313723709116474_r8, 0.2301031320055869_r8, 0.228819354763788_r8, 0.2275208726587316_r8,&
          0.2262075172554306_r8, 0.2248791181895803_r8, 0.2235355031454603_r8, 0.222176497833581_r8, 0.2208019259680765_r8,&
          0.2194116092438368_r8, 0.2180053673133784_r8, 0.2165830177634507_r8, 0.2151443760913736_r8, 0.2136892556811047_r8,&
          0.2122174677790316_r8, 0.2107288214694878_r8, 0.2092231236499875_r8, 0.207700179006177_r8, 0.2061597899864991_r8,&
          0.2046017567765677_r8, 0.2030258772732478_r8, 0.2014319470584399_r8, 0.1998197593725635_r8, 0.1981891050877367_r8,&
          0.1965397726806485_r8, 0.1948715482051216_r8, 0.193184215264359_r8, 0.1914775549828742_r8, 0.1897513459780993_r8,&
          0.1880053643316679_r8, 0.186239383560369_r8, 0.1844531745867685_r8, 0.1826465057094943_r8, 0.1808191425731797_r8,&
          0.1789708481380649_r8, 0.1771013826492478_r8, 0.1752105036055846_r8, 0.1732979657282328_r8, 0.1713635209288345_r8,&
          0.1694069182773354_r8, 0.1674279039694347_r8, 0.1654262212936626_r8, 0.1634016105980802_r8, 0.1613538092565985_r8,&
          0.1592825516349116_r8, 0.1571875690560389_r8, 0.1550685897654736_r8, 0.1529253388959313_r8, 0.1507575384316955_r8,&
          0.1485649071725539_r8, 0.146347160697322_r8, 0.1441040113269489_r8, 0.141835168087201_r8, 0.1395403366709169_r8,&
          0.1372192193998314_r8, 0.1348715151859615_r8, 0.1324969194925499_r8, 0.130095124294562_r8, 0.1276658180387296_r8,&
          0.1252086856031369_r8, 0.1227234082563444_r8, 0.1202096636160439_r8, 0.1176671256072397_r8, 0.1150954644199518_r8,&
          0.1124943464664335_r8, 0.1098634343379_r8, 0.1072023867607601_r8, 0.1045108585523475_r8, 0.1017885005761454_r8,&
          0.099034959696497_r8, 0.09624987873279756_r8, 0.0934328964131631_r8, 0.09058364732756641_r8, 0.08770176188043766_r8,&
          0.08478686624272158_r8, 0.08183858230338514_r8, 0.07885652762037132_r8, 0.07584031537098834_r8, 0.07278955430173351_r8,&
          0.06970384867754043_r8, 0.06658279823044599_r8, 0.06342599810766802_r8, 0.06023303881909015_r8, 0.05700350618414329_r8,&
          0.05373698127807958_r8, 0.05043304037763086_r8, 0.04709125490604504_r8, 0.04371119137749158_r8, 0.04029241134083184_r8,&
          0.03683447132274431_r8, 0.03333692277019873_r8, 0.02979931199227104_r8, 0.02622118010129237_r8, 0.0226020629533229_r8,&
          0.01894149108794563_r8, 0.01523898966736859_r8, 0.01149407841483052_r8, 0.007706271552301414_r8, 0.003875077737468202_r8,&
          0._r8/)

eta_face_b = (/0._r8, 0.003919464322917888_r8, 0.007883823651787022_r8, 0.01189359223074747_r8, 0.01594929019428304_r8,&
          0.02005144363469222_r8, 0.02420058467033059_r8, 0.02839725151463589_r8, 0.03264198854594341_r8, 0.0369353463781007_r8,&
          0.04127788193189189_r8, 0.04567015850727913_r8, 0.05011274585647277_r8, 0.05460622025783697_r8, 0.05915116459064369_r8,&
          0.06374816841068109_r8, 0.06839782802672914_r8, 0.07310074657791132_r8, 0.07785753411193111_r8, 0.08266880766420619_r8,&
          0.08753519133790777_r8, 0.09245731638491782_r8, 0.09743582128771239_r8, 0.1024713518421841_r8, 0.1075645612414127_r8,&
          0.1127161101603947_r8, 0.1179266668417447_r8, 0.1231969071823772_r8, 0.1285275148211823_r8, 0.1339191812277045_r8,&
          0.1393726057918384_r8, 0.1448884959145515_r8, 0.1504675670996456_r8, 0.1561105430465699_r8, 0.1618181557442969_r8,&
          0.1675911455662739_r8, 0.1734302613664615_r8, 0.1793362605764733_r8, 0.1853099093038263_r8, 0.1913519824313195_r8,&
          0.1974632637175477_r8, 0.2036445458985695_r8, 0.2098966307907379_r8, 0.2162203293947089_r8, 0.2226164620006428_r8,&
          0.2290858582946094_r8, 0.2356293574662117_r8, 0.242247808317444_r8, 0.2489420693727946_r8, 0.2557130089906116_r8,&
          0.2625615054757438_r8, 0.2694884471934705_r8, 0.276494732684739_r8, 0.283581270782719_r8, 0.2907489807306948_r8,&
          0.2979987923013058_r8, 0.3053316459171539_r8, 0.3127484927727922_r8, 0.3202502949581109_r8, 0.3278380255831367_r8,&
          0.3355126689042613_r8, 0.3432752204519164_r8, 0.3511266871597099_r8, 0.3590680874950435_r8, 0.3671004515912238_r8,&
          0.3752248213810886_r8, 0.3834422507321628_r8, 0.3917538055833631_r8, 0.4001605640832684_r8, 0.4086636167299728_r8,&
          0.4172640665125424_r8, 0.4259630290540918_r8, 0.4347616327564984_r8, 0.4436610189467754_r8, 0.4526623420251215_r8,&
          0.4617667696146656_r8, 0.4709754827129273_r8, 0.4802896758450127_r8, 0.489710557218563_r8, 0.499239348880481_r8,&
          0.5088772868754501_r8, 0.5186256214062706_r8, 0.5284856169960316_r8, 0.5384585526521417_r8, 0.5485457220322371_r8,&
          0.5587484336119906_r8, 0.5690680108548435_r8, 0.5795057923836814_r8, 0.5900631321544754_r8, 0.6007413996319124_r8,&
          0.6115419799670392_r8, 0.6224662741769396_r8, 0.6335156993264686_r8, 0.6446916887120709_r8, 0.6559956920477036_r8,&
          0.6674291756528872_r8, 0.6789936226429141_r8, 0.6906905331212304_r8, 0.7025214243740282_r8, 0.7144878310670608_r8,&
          0.7265913054447154_r8, 0.7388334175313646_r8, 0.751215755335027_r8, 0.7637399250533561_r8, 0.7764075512819926_r8,&
          0.7892202772253016_r8, 0.8021797649095239_r8, 0.815287695398368_r8, 0.8285457690110736_r8, 0.8419557055429712_r8,&
          0.8555192444885676_r8, 0.8692381452671889_r8, 0.8831141874512063_r8, 0.897149170996876_r8, 0.9113449164778251_r8,&
          0.9257032653212095_r8, 0.9402260800465783_r8, 0.9549152445074747_r8, 0.9697726641358018_r8, 0.9848002661889914_r8,&
          1._r8/)

#endif

#ifdef DCMIP_SUPERCELL 
       call calc_eta_face_supercell(nlevp, eta_face_a, eta_face_b)
     case(80, 160, 200)
       call calc_eta_face_supercell(nlevp, eta_face_a, eta_face_b)
#endif

     case(2400)
#ifdef DCMIP1
        ztop    = 12000
        dz      = ztop/nlev
        do ilev = 1, nlevp
           eta_face(ilev)   = exp(-gravity*(ztop-(ilev-1)*dz)/(rdry*300._r8))
           eta_face_b(ilev) = (eta_face(ilev)-eta_face(1))/(one-eta_face(1))
           eta_face_a(ilev) =  eta_face(ilev)-eta_face_b(ilev)
        end do
#endif


#ifdef DCMIP1
     case(240, 480, 600, 960, 1200, 1800, 2000)
       call calc_eta_face(nlevp, eta_face_a, eta_face_b)
#endif

     case default
         print*,"you must set nlev in grist.nml"
     end select

     eta_full_a = 0.5_r8*(eta_face_a(1:nlev)+eta_face_a(2:nlevp))
     eta_full_b = 0.5_r8*(eta_face_b(1:nlev)+eta_face_b(2:nlevp))
 
     eta_face   = eta_face_a+eta_face_b
     eta_full   = eta_full_a+eta_full_b

     deta_face(1)      = eta_full(1)-eta_face(1)
     deta_face(2:nlev) = eta_full(2:nlev)-eta_full(1:nlev-1)
     deta_face(nlev+1) = eta_face(nlev+1)-eta_full(nlev)
     deta_full         = eta_face(2:nlev+1)-eta_face(1:nlev)
!
     deta_face_b(1)      = eta_full_b(1)-eta_face_b(1)
     deta_face_b(2:nlev) = eta_full_b(2:nlev)-eta_full_b(1:nlev-1)
     deta_face_b(nlev+1) = eta_face_b(nlev+1)-eta_full_b(nlev)

     hypi = (eta_face_a+eta_face_b)*p0
     hypm = (eta_full_a+eta_full_b)*p0

     return
  end subroutine init_hpe_constants

  subroutine destruct_hpe_constants

     if(allocated(eta_face_a)) deallocate(eta_face_a)
     if(allocated(eta_face_b)) deallocate(eta_face_b)
     if(allocated(eta_face))   deallocate(eta_face)
     if(allocated(eta_full_a)) deallocate(eta_full_a)
     if(allocated(eta_full_b)) deallocate(eta_full_b)
     if(allocated(eta_full))   deallocate(eta_full)
     if(allocated(deta_face))  deallocate(deta_face)
     if(allocated(deta_face_b))deallocate(deta_face_b)
     if(allocated(deta_full))  deallocate(deta_full)

    return
  end subroutine destruct_hpe_constants

#ifdef DCMIP1
  subroutine calc_eta_face(nhalf, eta_a, eta_b)
    
    !-----------------------------------------------------------------
    ! Dynamical core model intercomparison project: Tracer transport
    ! test cases. kent et al 2014
    ! LiJianghao
    ! 2021.11
    !-----------------------------------------------------------------
    integer, intent(in) :: nhalf
    real(r8), intent(out) :: eta_a(nhalf), eta_b(nhalf)
    real(r8) dz, z, eta 
    integer ilev

    dz = ztop / (nhalf - 1)
    do ilev = 1, nhalf
      z = ztop - (ilev - 1) * dz
      eta = exp(-gravity * z / rdry / T0)
      eta_b(ilev) = (eta - eta_top) / (1.d0 - eta_top)
      eta_a(ilev) = eta - eta_b(ilev)
    end do

  end subroutine calc_eta_face
#endif

#ifdef DCMIP_SUPERCELL 
  subroutine calc_eta_face_supercell(nhalf, eta_a, eta_b)
    
    !-----------------------------------------------------------------
    ! DCMIP2016: the splitting supercell test case. Ullrich et al
    ! LiJianghao
    ! 2021.12.5
    !-----------------------------------------------------------------
    use grist_lib
    use grist_dtp_dcmip2016_sc, only : supercell_init, supercell_test 
    integer, intent(in)     :: nhalf
    real(r8), intent(inout) :: eta_a(nhalf), eta_b(nhalf)
    real(r8) ztop, ptop, u, v, t, thetav, thetap, rho, q, dz, p, z, ps, eta_top, eta
    real(r8), parameter :: lon = 0._r8, lat = 0._r8
    integer ilev

    eta_a = 0.d0
    eta_b = 0.d0
    ztop = 2.e4_r8
    dz = ztop / (nhalf - 1)

    call supercell_init
!    call supercell_test(lon, lat, p, ztop, ptop, ztop, 1, u, v, t, thetav, thetap, ps, rho, q, 0)
!    eta_top = p / ps

    do ilev = 1, nhalf
      z = ztop - (ilev - 1) * dz
      call supercell_test(lon, lat, p, z, ptop, ztop, 1, u, v, t, thetav, thetap, ps, rho, q, 0)
!      eta = p / ps 
!      eta_b(ilev) = (eta - eta_top) / (1.d0 - eta_top)
!      eta_a(ilev) = eta - eta_b(ilev)
      eta_b(ilev) = p / ps
    end do

    eta_a(1) = eta_b(1)
    eta_b(1) = 0.d0

  end subroutine calc_eta_face_supercell
#endif

end module grist_hpe_constants
